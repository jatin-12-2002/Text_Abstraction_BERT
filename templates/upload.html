<!DOCTYPE html>
<html lang="en">
<head>
	<title>iNeuron Upload Test</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="shortcut icon" href="data:image/png;base64,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" />
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
	<style>
		body{
			font-size:13px;
		}
		.table td, .table th{
			padding: 7px 10px;
			vertical-align: middle;
		}
		.table th{
			text-align:center;
		}
		.submit{
			font-size:13px;
		}
		.select{
			font-size:13px;
		}
		.response-tables{
			display:none;
		}
		.response-last-table{
			display:none;
		}

	</style>
</head>
<body>
<body>
	<div class="container">

		<div class="form-div pt-5">
			<form id="uploadForm" method="post" class="form-inline" role="form">
				<div class="form-group mr-2">
					<select name="fileName" class="browser-default custom-select select" id="selectFile" required>
						<option value="testStoryFile1.txt,testSummaryFile1.txt">TesInputFile1</option>
						<option value="testStoryFile2.txt,testSummaryFile2.txt">TesInputFile2</option>
						<option value="testStoryFile3.txt,testSummaryFile3.txt">TesInputFile3</option>
						<option value="testStoryFile4.txt,testSummaryFile4.txt">TesInputFile4</option>
						<option value="testStoryFile5.txt,testSummaryFile5.txt">TesInputFile5</option>
						<option value="testStoryFile6.txt,testSummaryFile6.txt">TesInputFile6</option>
						<option value="testStoryFile7.txt,testSummaryFile7.txt">TesInputFile7</option>
						<option value="testStoryFile8.txt,testSummaryFile8.txt">TesInputFile8</option>
						<option value="testStoryFile9.txt,testSummaryFile9.txt">TesInputFile9</option>
						<option value="testStoryFile10.txt,testSummaryFile10.txt">TesInputFile10</option>
					</select>
				</div>
				<div class="form-group mr-2">
					<div class="custom-file">
						<input type="file" class="custom-file-input" name="uploadFile" id="uploadFile" required>
						<label class="custom-file-label" for="customFile">Choose file</label>
					</div>
				</div>
				<div class="form-group mr-2"><button type="submit" id="btnSubmit" class="btn submit btn-primary">Predict</button></div>
			</form>

			  <div class="mt-4 progress"><div id="progressBar" class="progress-bar progress-bar-striped progress-bar-animated" style="width:0%"></div></div>

		</div>


		<div class="response-tables pt-5">
			<table class="table table-bordered">
				<thead class="thead-light"><tr><th>S.No</th><th>Input Story</th><th width="20%">Actual Summary</th><th width="20%">Predicted Summary</th></tr></thead>
				<tbody id="response-table-body">

				</tbody>
			</table>
		</div>

		<div class="response-last-table pt-5">
			<table class="table table-bordered text-center">
				<thead class="thead-light"><tr><th>Category</th><th>S.No</th><th>F1 Score</th><th>Precesion</th><th>Recall</th></tr></thead>
				<tbody id="rouge-table-body">

				</tbody>
			</table>
		</div>

	</div>
	<script>
		$(document).ready(function(e){
			$(".progress").hide();
			var bar = $('.bar');
			var percent = $('.percent');
			var status = $('#status');
			$(".custom-file-input").on("change", function(){
				var fileName = $(this).val().split("\\").pop();
				$(this).siblings(".custom-file-label").addClass("selected").html(fileName);
			});
			$("#uploadForm").on('submit',(function(e){
				$(".progress").show();
				$("#btnSubmit").attr('disabled',true);
				e.preventDefault();
				$.ajax({
					xhr: function(){
						var xhr = new window.XMLHttpRequest();
						xhr.upload.addEventListener("progress", function(evt){
							if (evt.lengthComputable) {
								var percentComplete = parseInt((evt.loaded / evt.total) * 100);
								$("#progressBar").width(percentComplete + '%');
								$("#progressBar").html(percentComplete + '%');
							}
					   }, false);
					   return xhr;
					},
					url: "/predict",
					type: "POST",
					data: new FormData(this),
					contentType: false,
					cache: false,
					processData:false,
					success: function(responseObject){
						$(".response-tables").show();
						$(".response-last-table").show();
						$(".progress").hide();
						$("#btnSubmit").attr('disabled',false);

						$("#predicted-summary-table-body").html("");
						$("#actual-summary-table-body").html("");
						$("#input-story-table-body").html("");

						var srNo = 1;
						var InputStory = responseObject.InputStory;
						var ActualSummary = responseObject.ActualSummary;
						var PredictedSummary = responseObject.PredictedSummary;
						for(var i=0;i<ActualSummary.length;i++){
							$("#response-table-body").append("<tr><td>" + srNo + "</td><td>"+ InputStory[i].replace(/(<|&lt;)br\s*\/*(>|&gt;)/g,' ') + " </td><td>"+ ActualSummary[i].replace(/(<|&lt;)br\s*\/*(>|&gt;)/g,' ') + " </td><td>"+ PredictedSummary[i].replace(/(<|&lt;)br\s*\/*(>|&gt;)/g,' ') + " </td></tr>");
							srNo++;
						}
						
						var counter = 1;
						var AccuracyN1 = responseObject.AccuracyN1;
						AccuracyN1.forEach(function(arrayItem){
							if(counter == 1){$("#rouge-table-body").append("<tr><td rowspan='10'>ROUGEN-1</td><td>" + counter + "</td><td>" + arrayItem.f + "</td><td>" + arrayItem.p + "</td><td>" + arrayItem.r + "</td></tr>");}
							else{$("#rouge-table-body").append("<tr><td>" + counter + "</td><td>" + arrayItem.f + "</td><td>" + arrayItem.p + "</td><td>" + arrayItem.r + "</td></tr>");}
							counter++;
						});
						
						var counter2 = 1;
						var AccuracyN2 = responseObject.AccuracyN2;
						AccuracyN2.forEach(function(arrayItem){
							if(counter2 == 1){$("#rouge-table-body").append("<tr><td rowspan='10'>ROUGEN-2</td><td>" + counter2 + "</td><td>" + arrayItem.f + "</td><td>" + arrayItem.p + "</td><td>" + arrayItem.r + "</td></tr>");}
							else{$("#rouge-table-body").append("<tr><td>" + counter2 + "</td><td>" + arrayItem.f + "</td><td>" + arrayItem.p + "</td><td>" + arrayItem.r + "</td></tr>");}
							counter2++;
						});
						
					}        
				});				
			}));
		});
	</script>
</body>
</html>